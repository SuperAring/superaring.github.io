<article>
  <!-- header becomes a dropdown menu -->
  <div class="dropdown" onmouseleave="dropdownHandler.delayedHide()">
    <button class="dropbtn" id="dropdown-title" onmouseover="dropdownHandler.show()">All</button>
    <div class="dropdown-content" id="dropdown-content" onmouseover="dropdownHandler.cancelHide()" onmouseleave="dropdownHandler.delayedHide()">
      <!-- Use a for loop to display all types -->
      {% for title in include.title %}
      <a href="#" onclick="filterPosts('{{ title }}'); dropdownHandler.hide()">{{ title }}</a>
      {% endfor %}
    </div>
  </div>

  <ul class="archive" id="archive">
    <!-- Add a data-type attribute to each li for filtering -->
    {% for post in site.posts %}
    <li data-type="{{ post.type }}">
      <time datetime="{{ post.date | date_to_xmlschema }}">{{ post.date | date: "%Y-%m-%d" }}</time>
      <a href="{{ post.url | relative_url }}">{{ post.title }}</a>
    </li>
    {% endfor %}
  </ul>
</article>

<script>
// JavaScript function to filter posts by type
function filterPosts(type) {
  // Update dropdown title
  document.getElementById('dropdown-title').innerText = type;

  // Get all posts
  const posts = document.getElementById('archive').children;

  // Loop over each post
  for (let i = 0; i < posts.length; i++) {
    const post = posts[i];

    // If the type is 'All' or matches the post type, show the post. Otherwise, hide it.
    if (type === 'All' || post.getAttribute('data-type') === type) {
      post.style.display = '';
    } else {
      post.style.display = 'none';
    }
  }
}

// Handler for dropdown actions
const dropdownHandler = (function() {
  const dropdownContent = document.getElementById('dropdown-content');
  let timeoutId;

  return {
    show: function() {
      dropdownContent.classList.add('show');
    },
    hide: function() {
      dropdownContent.classList.remove('show');
    },
    delayedHide: function() {
      clearTimeout(timeoutId);
      timeoutId = setTimeout(this.hide, 555);
    },
    cancelHide: function() {
      clearTimeout(timeoutId);
    }
  };
})();

// Function to handle clicks outside the dropdown
document.addEventListener('click', function(event) {
  const target = event.target;
  const dropdownButton = document.getElementById('dropdown-title');

  // Check if the clicked element is inside the dropdown or not
  if (
    !target.closest('.dropdown') &&
    !dropdownHandler.dropdownContent.classList.contains('show') &&
    target !== dropdownButton &&
    !target.closest('.dropdown-content')
  ) {
    dropdownHandler.hide();
  }
});
</script>

<style>
/* CSS for the dropdown menu */
.dropdown {
  position: relative;
  display: inline-block;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f1f1f1;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
  border-radius: 11px; /* 添加圆角边框 */
}

.dropdown-content.show {
  display: block;
}

.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
}

.dropdown-content a:first-child {
  border-top-left-radius: 11px; /* 添加圆角边框 */
  border-top-right-radius: 11px; /* 添加圆角边框 */
}

.dropdown-content a:last-child {
  border-bottom-left-radius: 11px; /* 添加圆角边框 */
  border-bottom-right-radius: 11px; /* 添加圆角边框 */
}

.dropdown-content a:hover {background-color: #ddd;}

.dropdown:hover .dropbtn {background-color: #3e8e41;}
</style>